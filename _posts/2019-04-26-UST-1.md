---
layout: post
title: "UST-10lx 파악하기_01"
date: 2019-04-26
excerpt: "센서 R&D"
tags: [UST, Sensor, Unity]
comments: true
---
# UST-10lx 파악하기_01
#### 01_리서치 돌입
>공간 인터렉션 컨텐츠에서 쓰이는 Hokuyo UST-10lx 센서를 파악하기 위해 진행된 R&D입니다.
이미 회사에서 사용되는 UST는 모듈을 비롯해 기능을 회사의 다른 개발자분께서 구현하여 사용가능한 상태입니다.
그래서 이 포스트는 처음부터 구현하는것이아닌 기존 모듈에대한 이해와 추후 다른방법으로도 응용할수있기를 기대하는 마음으로 시작하는 R&D입니다.



## INDEX
* 선행 수학 개념
* UST 센서
* 적용 개념 파악하기

---

## 선행 수학 개념
고등학생때 입시미술을하면서 수학(공부)은 내 인생에서 더 이상 없을것이라 생각하며 자타공인 수포자였던 때를 씁쓸하게 돌이켜보면서 UST센서 데이터를 얻어오기위한 선행 수학 개념에대해서 간단하게 스터디를 진행했다.
필요한 항목은 다음과 같으며 이해한바를 토대로 작성 하려한다.

자료 출처: https://mathbang.net/

<figure>

1. 피타고라스의 정리

        밑변 a, 높이 b, 빗변 c 인 **직각삼각형** 에 대해,
        a² + b² = c² 
        가장짧은변 : 중간길이 변 : 빗변

2. 호도법
    호도법이란 호의 길이를 이용해서 각도를 표시하는 방법이다. 
    부채꼴의 호의길이는 중심각에 비례하므로 원의둘레(2πr)와 부채꼴의 호의 길이를 이용하여 비례식을 세운다.

~~~
반지름 OA와 호 AB가 r인 부채꼴의 각 a
360˚ : 2πr  =  a˚ : r
2πr x a˚ = 360˚r  
...
a = 180 / π
1θ = 180 / π (세타(θ)는 변수 개념으로 호도법에서 자주쓰임.)
1˚ = π / 180  
~~~

* 부채꼴 호의 중심각 a는 반지름에 상관없이 항상 일정한 값을 갖게 되는데 이 값을 라디안이라고 한다.
* 결론적으로 호도법이란 라디안을 단위로하여 각도를 나타내는 방법을 말한다.
* 예)

    | 육십분법 | 호도법 |
    |:-|:-:|
    |   30˚   | π / 6  | 

3. 삼각비

    * 직각 삼각형에서 변의 길이 사이의 비율 (A는 기준각).

        * sin - 직각삼각형 두변의 길이 중 빗변과 높이의 길이의 비.
            sinA = 높이 / 빗변.
        * cos - 직각삼각형 두변의 길이 중 빗변과 밑변의 길이의 비.
            cosA = 밑변 / 빗변.
        * tan - 직각삼각형 두변의 길이 중 밑변과 높이의 길이의 비.
            tanA = 높이 / 밑변.

4. 삼각함수

* 삼각비 + 호도법 + 함수
* 좌표로 표현
* 삼각비처럼 직삼각형의 각변 길이의 관계를 함수로 나타낸것.

~~~
좌표평면에서 중점 O(0,0)을 중심으로 반지름 r을 가지는 원을 그리고 중점O를 잇는 동경 OP를 긋는다.
이때 동경 OP가 이루는 각을 θ라고 한다.

sinθ = y / r
cosθ = x / r
tanθ = y / x
~~~

</figure>

여기까지 내용을 이해하며 정리하고나니 회사의 개발자분께서 리뷰해주셨던 UST 데이터처리 자료를 어느정도 볼 수 있게 되었다. 수학방이라는 유용한 사이트가있으니 더 정확하고 자세한정보는 위 자료출처 링크를 방문하시면 좋을것 같다.

## UST센서
UST는 Hokuyo에서 만든 레이저센서(scanning laser range finder)이다.
이번 컨텐츠에 사용되는 UST-10LX는 10m까지 인지가 가능하며
UST-20LX는 20m까지 인지가 가능하다.

<figure>

<img src="https://i.imgur.com/DTMLO2E.png">

</figure>

* Detail

    인식 각도는 270˚, 거리는 0.02m에서 10m까지이며 총 1081 Steps을 가진다.
    전 버전 USB방식과는 다르게 Ethernet 100BAST-TX, 랜케이블 방식으로 통신한다. 
    하부에 열이 집중되기 때문에 열을 식힐 유닛(유닛은 200mm*200mm*2mm의 알류미늄 plate 권장)을 부착하는것을 권장하고있다.

* Software

    데이터을 볼수있는 Viewer를 비롯한 각종 소프트웨어는 Hokuyo 공식홈페이지(일본)에서 다운받을 수 있으며 이메일 인증으로 가입하면 다운로드 페이지에 접근할 수 있다.

## 적용 개념 파악하기
회사에서 사용하는 UST센서는 이미 데이터 처리하는 방식이 만들어져있기때문에 내가 직접 처음부터 제작하는것이아니다. 
이번 R&D는 먼저 만들어 둔 개념을 이해하므로서 문제가 발생했을때 스스로 해결방법을 사고하는 힘을 키우고싶어 진행한것이므로 **적용 개념 파악하기**는 회사 개발자분께서 만들어주신 자료를 이해하는 방향으로 작성될것이다.

상위 목록의 내용을 참고하여 다시 정리하면 다음과 같다.

* UST센서는 270˚를 감지하며 1081 steps을 가진다. 즉 1˚는 4steps과 같다.
* 제작되는 콘텐츠는 프로젝션맵핑을 사용하므로 벽면을 인식해야 하므로 180˚의 데이터 즉 720steps 을 사용한다.
* 데이터 추출방법
    * X,Y 좌표를 구하기 위해 UST Viewer에서 Distance를 알아낸다.
    * Distance를 r이라 했을때, 구하고자하는 x,y좌표에서 센서까지의 거리를 빗변으로 하는 직각삼각형 Δrxy를 그린다.
    * Δrxy의 기준각을 A라 했을때 A = Steps / 4 가된다.
    * 삼각비를 적용하면 X = r * cosA, Y = r * sinA 가 된다.
    * Unity는 라디안 체계를 사용하므로 (Math.PI / 180)을 곱해준다.
    * 예시

~~~
cosA = Math.Cos(A * (Math.PI / 180))
sinA = Math.Cos(A * (Math.PI / 180))
X = cosA * distance[Step]
Y = sinA * distance[Step]

적용)
Steps : 300
Distance : 2511
일때,
----------------
cosA = Math.Cos(75 * (Math.PI / 180))
sinA = Math.Cos(75 * (Math.PI / 180))
X = cosA * 2511[300]
Y = sinA * 2511[300]
~~~